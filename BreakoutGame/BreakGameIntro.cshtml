@using BreakoutGame.Helpers;
@using Common.JsInterop;
@inject Microsoft.AspNetCore.Blazor.Services.IUriHelper UriHelper
@implements IDisposable

<div class="slider" style="width: @(Constants.GameAreaWidth)px; height: @(Constants.GameAreaHeight)px">
    <div class="slides">
        <div id="intro1" class="breakout-game slide-content" style="width: @(Constants.GameAreaWidth)px; height: @(Constants.GameAreaHeight)px" onclick="@PlayGame">
            <div>
                <p class="intro-title">
                    Blaze-out
                </p>
            </div>

            <div class="intro-scorelist">
                <div class="intro-shipscore">
                    <div class="intro-redbrick">
                    </div>
                    <div class="intro-score">7 points</div>
                </div>
                <div class="intro-shipscore">
                    <div class="intro-orangebrick">
                    </div>
                    <div class="intro-score">5 points</div>
                </div>
                <div class="intro-shipscore">
                    <div class="intro-greenbrick">
                    </div>
                    <div class="intro-score">3 points</div>
                </div>
                <div class="intro-shipscore">
                    <div class="intro-bluebrick">
                    </div>
                    <div class="intro-score">1 point</div>
                </div>

                <div class="intro-end">Click or press space to start</div>
            </div>
        </div>

        <div id="intro2" class="breakout-game slider-content" style="width: @(Constants.GameAreaWidth)px; height: @(Constants.GameAreaHeight)px" onclick="@PlayGame">
            <div>
                <p class="intro-title">
                    Blaze-out
                </p>
            </div>

            <div class="intro-scorelist">
                <div class="intro-start">Keys to play:</div>
                <div class="intro-shipscore">
                    <div class="intro-inline">
                        Left / Right
                    </div>
                    ..........
                    <div class="intro-inline">&#8592;, &#8594; &nbsp; or &nbsp; A, D</div>
                </div>
                <div class="intro-shipscore">
                    <div class="intro-inline">
                        Pause / Unpause
                    </div>
                    ..........
                    <div class="intro-inline">P</div>
                </div>

                <div class="intro-end">Click or press space to start</div>
            </div>
        </div>
    </div>
</div>

@functions{
    protected override void OnInit()
    {
        Common.Global.CurrentGame = "breakout";
        base.OnInit();
        InteropKeyPress.RemoveAllEvents();
        InteropKeyPress.KeyDown += OnKeyDown;
    }

    private void OnKeyDown(object sender, ConsoleKey e)
    {
        //Console.WriteLine("Key: " + e);
        if (e == ConsoleKey.Spacebar)
        {
            InteropKeyPress.KeyDown -= OnKeyDown;
            InteropKeyPress.RemoveAllEvents();
            UriHelper.NavigateTo("breakoutplay");
        }
    }

    private void PlayGame()
    {
        InteropKeyPress.KeyDown -= OnKeyDown;
        InteropKeyPress.RemoveAllEvents();
        UriHelper.NavigateTo("breakoutplay");
    }

    public void Dispose()
    {
        //StateHasChanged();
        //StopGame();
    }
}
